spring:
  application:
    name: legal-assistant
  # 数据源配置
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/legal_assistant?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai&useSSL=false&allowPublicKeyRetrieval=true
    username: root
    password: root123456
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
  
  # Redis配置
  data:
    redis:
      host: localhost
      port: 6379
      password: 
      database: 0
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0
      timeout: 5000
  
  # 文件上传配置
  servlet:
    multipart:
      max-file-size: 100MB
      max-request-size: 100MB

# MyBatis Plus配置
mybatis-plus:
  mapper-locations: classpath*:mapper/**/*.xml
  type-aliases-package: com.legal.assistant.entity
  configuration:
    map-underscore-to-camel-case: true
#    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      logic-delete-field: isDeleted
      logic-delete-value: 1
      logic-not-delete-value: 0

# MinIO配置
minio:
  endpoint: http://localhost:9000
  access-key: minioadmin
  secret-key: minioadmin
  bucket-name: legal-assistant

# JWT配置
jwt:
  secret: legal-assistant-jwt-secret-key-2024-very-long-and-random-string-for-security
  expiration: 604800000  # 7天,单位:毫秒
  refresh-expiration: 2592000000  # 30天,单位:毫秒

# 短信服务配置(示例:阿里云)
sms:
  access-key-id: your_access_key_id
  access-key-secret: your_access_key_secret
  sign-name: 法律咨询助手
  template-code: SMS_123456789
  code-expiration: 300  # 验证码有效期5分钟,单位:秒
  send-limit-per-minute: 1  # 每分钟发送限制
  send-limit-per-day: 10  # 每天发送限制



# 业务配置
business:
  share:
    default-expiration-days: 7
    max-expiration-days: 30
  conversation:
    soft-delete-days: 30
  ocr:
    language: chi_sim+eng
  user:
    default-nickname-prefix: 用户
    avatar-max-size: 5242880  # 5MB,单位:字节
    bio-max-length: 500
    nickname-min-length: 2
    nickname-max-length: 20
    deactivate-retention-days: 30  # 注销后保留天数

# SpringDoc OpenAPI (Swagger) 配置
springdoc:
  override-with-generic-response: false
  remove-broken-reference-definitions: false
  swagger-ui:
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: alpha
  api-docs:
    path: /v3/api-docs
  group-configs:
    - group: 'default'
      paths-to-match: '/**'
      packages-to-scan: com.legal.assistant.controller
# knife4j的增强配置，不需要增强可以不配
knife4j:
  enable: true
  setting:
    language: zh_cn
ai:
  dashscope:
    api-key: sk-197a1ca0bca44229830a9a7ff2486347

# Agent 配置
agent:
  # 记忆配置
  memory:
    # 记忆类型: AUTO_CONTEXT (智能上下文记忆) 或 IN_MEMORY (简单内存记忆)
    type: AUTO_CONTEXT
    # 消息阈值：当消息数量达到此值时，开始压缩历史消息
    msg-threshold: 30
    # 保留最后 N 条消息不被压缩
    last-keep: 10
    # Token 比例：保留 30% 的 token
    token-ratio: 0.3
  # 会话配置
  session:
    expire-days: 7  # 会话记忆过期时间（天）


# 服务器配置
server:
  # 服务器基础 URL（用于生成下载链接）
  base-url: http://localhost:8080
  port: 8080

# 日志配置
logging:
  level:
    com.legal.assistant: debug
    org.springframework.web: info
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
